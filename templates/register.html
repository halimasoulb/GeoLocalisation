{% extends "layout.html" %}
{% block content %}
    <script>
        $(document).ready(function () {
            $(function () {
                $('#datePicker').datetimepicker();
                $('.datepicker').datepicker();
            })

            $(function () {
                var e = document.getElementById("employe");
                var cl = e.options[e.selectedIndex].value;
                console.log(cl);
                
            })

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    currentPosition = {
                                        'latitude': position.coords.latitude,
                                        'longitude': position.coords.longitude
                                      } 
                    $.ajax({
                        url: '/position',
                        type: 'POST',
                        data: JSON.stringify(currentPosition),
                        contentType: 'application/json;charset=UTF-8',
                        cache:false,
                        error: function(response){
                            alert('Error sending position')
                        }
                    });
                });
            } 
            else {
                alert("Geolocation is not supported by this browser.");
            }
        })
        
        $('#employe').click(function(){
            var e = document.getElementById("employe");
            var cl = e.options[e.selectedIndex].value;
            console.log(cl);
            if(cl =="non"){
                $(".si-employe-province").hide('slow');
            }
            if(cl =="oui"){
                $(".si-employe-province").show('slow');
            }
        });
        $('#employe').trigger('click');
    </script>
    <div class="register-section box" >
        <form method="POST" action="">
            {{ form.hidden_tag() }}
            {% from "_formhelpers.html" import render_field, render_radio %}
            <fieldset class="form-group">
                <legend class="border border-primary mb-4 col-md-12">Enregistrer Nouveaux Cas</legend>
                <div class="form-group col-md-6" >
                    {{render_field(form.nom)}}
                </div>
                <div class="form-group col-md-6">
                    {{render_field(form.prenom)}}  
                </div>
                <div class="form-group col-md-6" >
                    {{render_field(form.sexe)}}  
                </div>
                <div class="form-group col-md-6" >
                    {{render_field(form.cin)}}
                </div>
                <div class="form-group col-md-4" data-provide="datepicker">
                    {{render_field(form.date_de_naissance)}}
                </div>
                <div class="form-group col-md-8">
                    {{render_field(form.adresse)}}
                </div>
                <div class="form-group col-md-12">
                    {{render_field(form.date)}}
                </div>
                <legend class="border border-secondary mb-4 col-md-12">Informations complementaires</legend>
                <div class="form-group col-md-12">
                    {{render_field(form.pachalik)}}
                </div>
                <div class="form-group col-md-12 ">
                    {{render_field(form.aal)}}
                </div>
                <div class="form-group col-md-12">
                    {{render_field(form.residance)}}
                </div>
                <div class="form-group col-md-12" id="employe" >
                    {{render_field(form.employe)}}
                </div>
                <div class="si-employe-province" style="display:none;">
                <div class="form-group col-md-12">
                    {{render_field(form.id_societe)}}
                </div>
                 <div class="form-group col-md-12">
                    {{render_field(form.nom_societe)}}
                </div>
                </div>
                <div class="form-group col-md-12">
                    {{render_field(form.observation)}}
                </div>

            </fieldset>
            <div class="form-group">
                {{ form.submit(class="btn btn-outline-info") }}
            </div>
        </form>
    </div>
     <div id="mapid"></div>
{% endblock content %}
